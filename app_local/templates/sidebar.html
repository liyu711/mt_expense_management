<div class="sidebar-nav">
    <div class="nav-group">
        <div class="nav-link nav-group-title collapsible" id="admin-options-toggle">
            Basic Data Maintenance
            <span class="collapse-arrow" id="admin-arrow">&#9654;</span>
        </div>
        <div class="nav-sublinks collapsible-content" id="admin-options-content" style="display:none;">
            <a href="/reset" class="nav-link nav-sublink{% if request.path == '/reset' %} active{% endif %}">Reset Database</a>
            <a href="/modify_po" class="nav-link nav-sublink{% if request.path == '/modify_po' %} active{% endif %}">PO Name</a>
            <a href="/modify_department" class="nav-link nav-sublink{% if request.path == '/modify_department' %} active{% endif %}">BU Name</a>
            <a href="/modify_porject_category" class="nav-link nav-sublink{% if request.path == '/modify_porject_category' %} active{% endif %}">Project Category</a>
            <a href="/modify_staff_categories" class="nav-link nav-sublink{% if request.path == '/modify_staff_categories' %} active{% endif %}">Staff categories</a>
            <!-- <div class="nav-link nav-subgroup-title">Modify users</div>
            <a href="/add_user" class="nav-link nav-sublink{% if request.path == '/add_user' %} active{% endif %}">Add user</a>
            <a href="/delete_user" class="nav-link nav-sublink{% if request.path == '/delete_user' %} active{% endif %}">Delete user</a>
            <a href="/modify_user_type" class="nav-link nav-sublink{% if request.path == '/modify_user_type' %} active{% endif %}">Modify user type</a> -->
        </div>
    </div>
    <div class="nav-group">
        <div class="nav-link nav-group-title collapsible" id="create-options-toggle">
            Create Forecast
            <span class="collapse-arrow" id="create-arrow">&#9654;</span>
        </div>
        <div class="nav-sublinks collapsible-content" id="create-options-content" style="display:none;">
            <a href="/modify_project" class="nav-link nav-sublink{% if request.path == '/modify_project' %} active{% endif %}">Create Project</a>
            <!-- <a href="/modify_io" class="nav-link nav-sublink{% if request.path == '/modify_io' %} active{% endif %}">Create IO</a> -->
            <a href="/manual_input" class="nav-link nav-sublink{% if request.path == '/manual_input' %} active{% endif %}" id="create-forecast-link">Create forecast</a>
            <a href="/capex_forecast" class="nav-link nav-sublink{% if request.path == '/capex_forecast' %} active{% endif %}">Capex forecast</a>
        </div>
    </div>

    <div class="nav-group">
        <div class="nav-link nav-group-title collapsible" id="create-funding-toggle">
            Create Funding
            <span class="collapse-arrow" id="create-funding-arrow">&#9654;</span>
        </div>
        <div class="nav-sublinks collapsible-content" id="create-funding-content" style="display:none;">
            <a href="/modify_funding" class="nav-link nav-sublink{% if request.path == '/modify_funding' %} active{% endif %}" id="nav-create-funding">Create funding</a>
        </div>
    </div>

    <div class="nav-group">
        <div class="nav-link nav-group-title collapsible" id="create-budgets-toggle">
            Create Budgets
            <span class="collapse-arrow" id="create-budgets-arrow">&#9654;</span>
        </div>
        <div class="nav-sublinks collapsible-content" id="create-budgets-content" style="display:none;">
            <a href="/upload_budget" class="nav-link nav-sublink{% if request.path == '/upload_budget' %} active{% endif %}" id="nav-upload-budget">Create budget</a>
            <!-- <a href="/modify_funding" class="nav-link nav-sublink{% if request.path == '/moidfy_funding' %} active{% endif %}">Create funding</a> -->
            <a href="/capex_budget" class="nav-link nav-sublink{% if request.path == '/capex_budget' %} active{% endif %}">Capex budget</a>
        </div>
    </div>

    <div class="nav-group">
        <div class="nav-link nav-group-title collapsible" id="data-visualization-toggle">
            Data Visualization
            <span class="collapse-arrow" id="data-visualization-arrow">&#9654;</span>
        </div>
        <div class="nav-sublinks collapsible-content" id="data-visualization-content" style="display:none;">
            <a href="/select" class="nav-link nav-sublink{% if request.path == '/select' %} active{% endif %}" id="nav-select">Display Raw Data</a>
            <a href="/data_summary" class="nav-link nav-sublink{% if request.path == '/data_summary' %} active{% endif %}" id="nav-data-summary">Data Summary</a>
            <a href="/data_vis" class="nav-link nav-sublink{% if request.path == '/data_visualization' %} active{% endif %}">Plot Graphs</a>
        </div>
    </div>

    <!-- Remaining links moved to end -->
    <div class="nav-group">
        <div class="nav-link nav-group-title collapsible" id="finance-toggle">
            Finance
            <span class="collapse-arrow" id="finance-arrow">&#9654;</span>
        </div>
        <div class="nav-sublinks collapsible-content" id="finance-content" style="display:none;">
            <a href="/modify_staff_cost" class="nav-link nav-sublink{% if request.path == '/modify_staff_cost' %} active{% endif %}">Modify Staff Cost</a>
            <a href="/file_upload" class="nav-link nav-sublink{% if request.path == '/file_upload' %} active{% endif %}" id="nav-file-upload">Upload actual expenditures or history files</a>
        </div>
    </div>
</div>
<script>
// Collapsible admin options (preserve state on nav-sublink click)
document.addEventListener('DOMContentLoaded', function() {
    // Admin options collapsible
    var adminToggle = document.getElementById('admin-options-toggle');
    var adminContent = document.getElementById('admin-options-content');
    var adminArrow = document.getElementById('admin-arrow');
    var adminExpanded = localStorage.getItem('adminOptionsExpanded') === 'true';
    function setAdminState(expanded) {
        if (expanded) {
            adminContent.style.display = 'block';
            adminArrow.style.transform = 'rotate(90deg)';
        } else {
            adminContent.style.display = 'none';
            adminArrow.style.transform = 'rotate(0deg)';
        }
        localStorage.setItem('adminOptionsExpanded', expanded);
    }
    if (adminToggle && adminContent && adminArrow) {
        setAdminState(adminExpanded);
        adminArrow.style.transition = 'transform 0.2s';
        adminToggle.addEventListener('click', function(e) {
            if (e.target === adminToggle || e.target === adminArrow) {
                var isExpanded = adminContent.style.display === 'block';
                setAdminState(!isExpanded);
            }
        });
    }

    // Create options collapsible
    var createToggle = document.getElementById('create-options-toggle');
    var createContent = document.getElementById('create-options-content');
    var createArrow = document.getElementById('create-arrow');
    var createExpanded = localStorage.getItem('createOptionsExpanded') === 'true';
    function setCreateState(expanded) {
        if (expanded) {
            createContent.style.display = 'block';
            createArrow.style.transform = 'rotate(90deg)';
        } else {
            createContent.style.display = 'none';
            createArrow.style.transform = 'rotate(0deg)';
        }
        localStorage.setItem('createOptionsExpanded', expanded);
    }
    if (createToggle && createContent && createArrow) {
        setCreateState(createExpanded);
        createArrow.style.transition = 'transform 0.2s';
        createToggle.addEventListener('click', function(e) {
            if (e.target === createToggle || e.target === createArrow) {
                var isExpanded = createContent.style.display === 'block';
                setCreateState(!isExpanded);
            }
        });
    }

    // Create Funding collapsible
    var createFundingToggle = document.getElementById('create-funding-toggle');
    var createFundingContent = document.getElementById('create-funding-content');
    var createFundingArrow = document.getElementById('create-funding-arrow');
    var createFundingExpanded = localStorage.getItem('createFundingExpanded') === 'true';
    function setCreateFundingState(expanded) {
        if (expanded) {
            createFundingContent.style.display = 'block';
            createFundingArrow.style.transform = 'rotate(90deg)';
        } else {
            createFundingContent.style.display = 'none';
            createFundingArrow.style.transform = 'rotate(0deg)';
        }
        localStorage.setItem('createFundingExpanded', expanded);
    }
    if (createFundingToggle && createFundingContent && createFundingArrow) {
        setCreateFundingState(createFundingExpanded);
        createFundingArrow.style.transition = 'transform 0.2s';
        createFundingToggle.addEventListener('click', function(e) {
            if (e.target === createFundingToggle || e.target === createFundingArrow) {
                var isExpanded = createFundingContent.style.display === 'block';
                setCreateFundingState(!isExpanded);
            }
        });
    }

    // Create Budgets collapsible
    var createBudgetsToggle = document.getElementById('create-budgets-toggle');
    var createBudgetsContent = document.getElementById('create-budgets-content');
    var createBudgetsArrow = document.getElementById('create-budgets-arrow');
    var createBudgetsExpanded = localStorage.getItem('createBudgetsExpanded') === 'true';
    function setCreateBudgetsState(expanded) {
        if (expanded) {
            createBudgetsContent.style.display = 'block';
            createBudgetsArrow.style.transform = 'rotate(90deg)';
        } else {
            createBudgetsContent.style.display = 'none';
            createBudgetsArrow.style.transform = 'rotate(0deg)';
        }
        localStorage.setItem('createBudgetsExpanded', expanded);
    }
    if (createBudgetsToggle && createBudgetsContent && createBudgetsArrow) {
        setCreateBudgetsState(createBudgetsExpanded);
        createBudgetsArrow.style.transition = 'transform 0.2s';
        createBudgetsToggle.addEventListener('click', function(e) {
            if (e.target === createBudgetsToggle || e.target === createBudgetsArrow) {
                var isExpanded = createBudgetsContent.style.display === 'block';
                setCreateBudgetsState(!isExpanded);
            }
        });
    }

    // Data Visualization collapsible
    var dataVizToggle = document.getElementById('data-visualization-toggle');
    var dataVizContent = document.getElementById('data-visualization-content');
    var dataVizArrow = document.getElementById('data-visualization-arrow');
    var dataVizExpanded = localStorage.getItem('dataVisualizationExpanded') === 'true';
    function setDataVizState(expanded) {
        if (expanded) {
            dataVizContent.style.display = 'block';
            dataVizArrow.style.transform = 'rotate(90deg)';
        } else {
            dataVizContent.style.display = 'none';
            dataVizArrow.style.transform = 'rotate(0deg)';
        }
        localStorage.setItem('dataVisualizationExpanded', expanded);
    }
    if (dataVizToggle && dataVizContent && dataVizArrow) {
        setDataVizState(dataVizExpanded);
        dataVizArrow.style.transition = 'transform 0.2s';
        dataVizToggle.addEventListener('click', function(e) {
            if (e.target === dataVizToggle || e.target === dataVizArrow) {
                var isExpanded = dataVizContent.style.display === 'block';
                setDataVizState(!isExpanded);
            }
        });
    }

    // Finance collapsible
    var financeToggle = document.getElementById('finance-toggle');
    var financeContent = document.getElementById('finance-content');
    var financeArrow = document.getElementById('finance-arrow');
    var financeExpanded = localStorage.getItem('financeExpanded') === 'true';
    function setFinanceState(expanded) {
        if (expanded) {
            financeContent.style.display = 'block';
            financeArrow.style.transform = 'rotate(90deg)';
        } else {
            financeContent.style.display = 'none';
            financeArrow.style.transform = 'rotate(0deg)';
        }
        localStorage.setItem('financeExpanded', expanded);
    }
    if (financeToggle && financeContent && financeArrow) {
        setFinanceState(financeExpanded);
        financeArrow.style.transition = 'transform 0.2s';
        financeToggle.addEventListener('click', function(e) {
            if (e.target === financeToggle || e.target === financeArrow) {
                var isExpanded = financeContent.style.display === 'block';
                setFinanceState(!isExpanded);
            }
        });
    }
});
</script>
<style>
.sidebar-nav {
    position: fixed;
    left: 0;
    top: 0;
    width: 220px;
    height: 100vh;
    background: #f8f9fa;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    padding: 32px 0 0 0;
    border-right: 1px solid #ddd;
    z-index: 100;
    overflow-y: auto;
}
.collapsible {
    cursor: pointer;
    user-select: none;
    display: flex;
    align-items: center;
    justify-content: space-between;
}
.collapse-arrow {
    font-size: 1em;
    margin-left: 8px;
    transition: transform 0.2s;
}
.nav-link {
    display: block;
    width: 100%;
    padding: 16px 16px 16px 32px;
    color: #333;
    text-decoration: none;
    font-size: 1.1em;
    transition: background 0.2s, color 0.2s;
    box-sizing: border-box;
}
.nav-group {
    width: 100%;
}
.nav-group-title {
    font-weight: bold;
    font-size: 1.05em;
    padding: 12px 16px 4px 32px;
    color: #555;
    background: none;
    cursor: default;
}
.nav-subgroup-title {
    font-weight: 500;
    font-size: 1em;
    padding: 8px 16px 4px 48px;
    color: #666;
    background: none;
    cursor: default;
}
.nav-sublinks {
    width: 100%;
}
.nav-sublink {
    padding-left: 64px;
    font-size: 1em;
}
.nav-link:hover, .nav-link.active {
    background: #007bff;
    color: #fff;
}
body {
    margin-left: 220px;
}
</style>
